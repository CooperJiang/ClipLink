(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[40],{85778:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var a=t(95155),r=t(12115),i=t(51228),o=t(60136),c=t(26420),l=t(99749),d=t(14809);function n(){let[e,s]=(0,r.useState)([]),[t,n]=(0,r.useState)(!1),[u,h]=(0,r.useState)(),[f,m]=(0,r.useState)(!0),[g,v]=(0,r.useState)(1),[x,y]=(0,r.useState)(1),[p,w]=(0,r.useState)(!1),[b,j]=(0,r.useState)(!1),{showToast:N}=(0,d.d)(),S=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];1===t?m(!0):a&&w(!0);try{let r=await l.G.getFavorites(t,12);if(r.success&&r.data){let i=[],o=t,c=1;if(Array.isArray(r.data)?(i=r.data,o=t,c=1):"items"in r.data&&(i=r.data.items,o=r.data.page,c=r.data.totalPages),console.log("收藏夹数据:",i),1!==t&&a){let t=new Set(e.map(e=>e.id)),a=i.filter(e=>!t.has(e.id));s(e=>[...e,...a])}else s(i||[]);v(o),y(c),j(o<c)}else N(r.message||"获取收藏失败","error")}catch(e){console.error("获取收藏失败:",e),N("获取收藏失败","error")}finally{m(!1),w(!1)}};(0,r.useEffect)(()=>{S()},[]);let C=async e=>{if(window.confirm("确定要删除这个收藏项目吗？"))try{let t=await l.G.deleteClipboard(e.id);t.success?(s(s=>s.filter(s=>s.id!==e.id)),N("删除成功","success")):N(t.message||"删除失败","error")}catch(e){console.error("删除失败:",e),N("删除失败","error")}},_=async e=>{try{let t=await l.G.toggleFavorite(e.id,!e.isFavorite);t.success?e.isFavorite?(s(s=>s.filter(s=>s.id!==e.id)),N("已取消收藏","success")):(await S(),N("已添加到收藏","success")):N(t.message||"切换收藏状态失败","error")}catch(e){console.error("切换收藏状态失败:",e),N("切换收藏状态失败","error")}},A=async e=>{if(u)try{let t=await l.G.updateClipboard(u.id,e);t.success&&t.data?(s(e=>e.map(e=>e.id===u.id?t.data:e)),N("保存成功","success")):N(t.message||"保存失败","error")}catch(e){throw console.error("保存失败:",e),N("保存失败","error"),e}};return(0,a.jsxs)(i.A,{children:[(0,a.jsxs)("div",{className:"bg-white border-b border-gray-200 p-4",children:[(0,a.jsx)("h1",{className:"text-lg font-medium",children:"收藏夹"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"在这里查看您收藏的所有剪贴板项目"})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,a.jsx)("div",{className:"h-full overflow-y-auto custom-scrollbar p-4",children:f?(0,a.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,a.jsx)("span",{className:"text-gray-400",children:"加载中..."})}):(0,a.jsx)(o.A,{items:e,onCopy:e=>{navigator.clipboard.writeText(e.content).then(()=>N("已复制到剪贴板","success")).catch(()=>N("复制失败","error"))},onEdit:e=>{h(e),n(!0)},onDelete:C,onToggleFavorite:_,hasMore:b,onLoadMore:()=>{g<x&&!p&&S(g+1,!0)},isLoadingMore:p})})}),(0,a.jsx)(c.A,{isOpen:t,onClose:()=>{n(!1),h(void 0)},onSave:A,initialData:u})]})}},94678:(e,s,t)=>{Promise.resolve().then(t.bind(t,85778))}},e=>{var s=s=>e(e.s=s);e.O(0,[266,181,220,908,608,441,684,358],()=>s(94678)),_N_E=e.O()}]);